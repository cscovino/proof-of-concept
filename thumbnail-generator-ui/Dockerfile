FROM node:alpine
WORKDIR /app/

COPY package.json .

RUN npm install -g serve
RUN yarn install

ADD public public
ADD src src

ARG REACT_APP_UI_PORT
ARG REACT_APP_API
ARG REACT_APP_API_PORT

ENV REACT_APP_API $REACT_APP_API
ENV REACT_APP_API_PORT $REACT_APP_API_PORT
ENV REACT_APP_UI_PORT $REACT_APP_UI_PORT

EXPOSE ${REACT_APP_UI_PORT}

RUN yarn build

CMD serve -s build -l ${REACT_APP_UI_PORT}